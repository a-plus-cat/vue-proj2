(function(t){function e(e){for(var a,r,c=e[0],s=e[1],l=e[2],u=0,p=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a]);d&&d(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},o={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/vue-proj2/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"263d":function(t,e,n){},"4c62":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),o=Object(a["g"])("div",{id:"map"},null,-1);function i(t,e,n,i,r,c){var s=Object(a["n"])("functionBtns"),l=Object(a["n"])("restaurantList");return Object(a["i"])(),Object(a["d"])(a["a"],null,[o,Object(a["g"])(s),Object(a["g"])(l)],64)}n("b0c0");var r=Object(a["u"])("data-v-4b9d924c");Object(a["k"])("data-v-4b9d924c");var c={class:"accordion",id:"restaurantList"},s={class:"titleText"},l={class:"accordion-body"},d=Object(a["f"])("地址 :"),u=Object(a["g"])("br",null,null,-1),p=Object(a["g"])("p",null,null,-1);Object(a["j"])();var b=r((function(t,e,n,o,i,r){return Object(a["i"])(),Object(a["d"])("div",c,[(Object(a["i"])(!0),Object(a["d"])(a["a"],null,Object(a["m"])(o.restaurants,(function(t){return Object(a["i"])(),Object(a["d"])("div",{class:"accordion-item",key:t.id},[Object(a["g"])("h2",{class:"accordion-header",id:t.id},[Object(a["g"])("button",{class:"accordion-button collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":r.addSpecChar(t.placeId),"aria-expanded":"true","aria-controls":t.placeId,onClick:function(e){return r.markerHandle(e,t)}},[Object(a["g"])("span",s,Object(a["o"])(t.name),1)],8,["data-bs-target","aria-controls","onClick"])],8,["id"]),Object(a["g"])("div",{id:t.placeId,class:"accordion-collapse collapse","aria-labelledby":t.id,"data-bs-parent":"#restaurantList"},[Object(a["g"])("div",l,[Object(a["g"])("img",{src:t.imgUrl,style:{width:"100%"}},null,8,["src"]),Object(a["g"])("h4",null,Object(a["o"])(t.name),1),Object(a["g"])("p",null,"營業狀態 : "+Object(a["o"])(t.openingOrNot?"營業中":"未營業"),1),Object(a["g"])("p",null,"評價 : "+Object(a["o"])(-1===t.rating?"???":t.rating)+" 顆星",1),Object(a["g"])("p",null,"價位 : "+Object(a["o"])(t.priceLevel===1/0?"???":t.priceLevel)+" 級",1),Object(a["g"])("p",null,[d,u,Object(a["f"])(" "+Object(a["o"])(t.addr),1)]),Object(a["g"])("p",null,"電話 : "+Object(a["o"])(t.tel),1),Object(a["g"])("p",null,"距離 : "+Object(a["o"])(Math.ceil(t.minDist))+" 公尺",1),p])],8,["id","aria-labelledby"])])})),128))])})),g=n("5502"),f=null,m=[],O={name:"restaurantList",methods:{addSpecChar:function(t){return"#".concat(t)},markerHandle:function(t,e){for(var n=0;n<m.length;n++)m[n].setMap(null);m=[];var a=!!t&&(t.target.classList.contains("collapsed")||t.target.parentNode.classList.contains("collapsed"));f===e.placeId||a?f=null:(m.push(new google.maps.Marker({map:this.$store.getters.getMap,position:e.coords,icon:{url:"https://maps.google.com/mapfiles/kml/shapes/dining.png",scaledSize:new google.maps.Size(30,30)}})),f=e.placeId)}},setup:function(){var t=Object(g["b"])();return{restaurants:Object(a["b"])((function(){return t.getters.getResList}))}}};n("dc9a");O.render=b,O.__scopeId="data-v-4b9d924c";var v=O,j=Object(a["u"])("data-v-4b718ff3");Object(a["k"])("data-v-4b718ff3");var h={class:"btnField"},y={class:"dropdown"},w=Object(a["g"])("button",{class:"btn btn-info dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," 列表排序 ",-1),L={class:"dropdown-menu dropdown-menu-dark","aria-labelledby":"dropdownMenuButton1"},k=Object(a["g"])("button",{type:"button",class:"btn btn-warning",id:"viewList"},"👀",-1),M=Object(a["g"])("button",{type:"button",class:"btn btn-success",id:"viewList"},"📍",-1),x={class:"modal fade",id:"listFilter",tabindex:"-1"},_={class:"modal-dialog modal-sm"},P={class:"modal-content"},R=Object(a["g"])("div",{class:"modal-header"},[Object(a["g"])("h5",{class:"modal-title"},"搜尋過濾設定"),Object(a["g"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},I={class:"input-group mb-3"},S=Object(a["g"])("div",{class:"input-group-text"},"營業狀態",-1),B={class:"d-flex justify-content-center align-items-center",style:{"padding-left":"1vw"}},N={class:"form-check form-check-inline"},T=Object(a["g"])("label",{class:"form-check-label",for:"inlineRadio1"},"不限",-1),$={class:"form-check form-check-inline"},D=Object(a["g"])("label",{class:"form-check-label",for:"inlineRadio2"},"營業中",-1),E={class:"input-group mb-3"},U={for:"radius",class:"input-group-text"},z={class:"input-group mb-3"},F=Object(a["g"])("label",{class:"input-group-text",for:"ratingLimit"},"最高價位",-1),V=Object(a["e"])('<option value="0" data-v-4b718ff3>Free</option><option value="1" data-v-4b718ff3>💰</option><option value="2" data-v-4b718ff3>💰💰</option><option value="3" selected data-v-4b718ff3>💰💰💰</option><option value="4" data-v-4b718ff3>💰💰💰💰</option>',5),A={class:"modal-footer"},H=Object(a["g"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);Object(a["j"])();var J=j((function(t,e,n,o,i,r){return Object(a["i"])(),Object(a["d"])(a["a"],null,[Object(a["g"])("div",h,[Object(a["g"])("div",y,[w,Object(a["g"])("ul",L,[Object(a["g"])("li",null,[Object(a["g"])("a",{class:"dropdown-item",href:"#",onClick:e[1]||(e[1]=function(t){return r.sortList("minDist")})},"依距離近->遠")]),Object(a["g"])("li",null,[Object(a["g"])("a",{class:"dropdown-item",href:"#",onClick:e[2]||(e[2]=function(t){return r.sortList("rating")})},"依評分高->低")]),Object(a["g"])("li",null,[Object(a["g"])("a",{class:"dropdown-item",href:"#",onClick:e[3]||(e[3]=function(t){return r.sortList("priceLevel")})},"依價位低->高")])])]),Object(a["g"])("button",{type:"button",class:"btn btn-danger titleText","data-bs-toggle":"modal","data-bs-target":"#listFilter",style:{"min-width":"7vw"},onClick:e[4]||(e[4]=function(t){return r.init()})},"搜尋過濾"),k,M]),Object(a["g"])("div",x,[Object(a["g"])("div",_,[Object(a["g"])("div",P,[R,Object(a["g"])("div",C,[Object(a["g"])("div",I,[S,Object(a["g"])("div",B,[Object(a["g"])("div",N,[Object(a["t"])(Object(a["g"])("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"inlineRadio1",value:"","onUpdate:modelValue":e[5]||(e[5]=function(t){return i.openNow=t})},null,512),[[a["p"],i.openNow]]),T]),Object(a["g"])("div",$,[Object(a["t"])(Object(a["g"])("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"inlineRadio2",value:"true","onUpdate:modelValue":e[6]||(e[6]=function(t){return i.openNow=t})},null,512),[[a["p"],i.openNow]]),D])])]),Object(a["g"])("div",E,[Object(a["g"])("label",U,"搜尋半徑 : "+Object(a["o"])(i.distance)+" 公尺",1),Object(a["t"])(Object(a["g"])("input",{type:"range","onUpdate:modelValue":e[7]||(e[7]=function(t){return i.distance=t}),class:"form-range",min:"100",max:"3000",step:"100",id:"radius"},null,512),[[a["r"],i.distance]])]),Object(a["g"])("div",z,[F,Object(a["t"])(Object(a["g"])("select",{class:"form-select",id:"ratingLimit","onUpdate:modelValue":e[8]||(e[8]=function(t){return i.MaxPriceLevel=t})},[V],512),[[a["q"],i.MaxPriceLevel]])])]),Object(a["g"])("div",A,[H,Object(a["g"])("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=function(t){return r.customizeSearch()})},"確定")])])])])],64)})),K={name:"functionBtns",data:function(){return{openNow:"",distance:100,MaxPriceLevel:"3"}},methods:{sortList:function(t){var e=this.$store.getters.getResList.sort((function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:0}));"rating"===t&&e.reverse(),this.$store.dispatch("sortRestaurants",e)},init:function(){this.openNow="",this.distance=100,this.MaxPriceLevel="3"},customizeSearch:function(){var t=bootstrap.Modal.getInstance(document.getElementById("listFilter")),e={location:this.$store.getters.getMap.getCenter(),radius:this.distance,type:"restaurant",openNow:!!this.openNow,MaxPriceLevel:this.MaxPriceLevel};this.$store.dispatch("findOutRestaurants",e),t.hide()}},mounted:function(){var t=document.getElementById("viewList");t.addEventListener("click",(function(){var t=document.getElementById("restaurantList");t.style.visibility="hidden"===t.style.visibility?"visible":"hidden"}))}};n("e38d");K.render=J,K.__scopeId="data-v-4b718ff3";var q=K,G={name:"App",components:{restaurantList:v,functionBtns:q},methods:{initMap:function(){var t=this,e=new google.maps.Map(document.getElementById("map"),{center:{lat:25.041715,lng:121.556882},zoom:15,mapTypeId:"roadmap",styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]}),n=new google.maps.Marker({map:e,position:e.getCenter(),label:"我",animation:google.maps.Animation.DROP});navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){var a={lat:t.coords.latitude,lng:t.coords.longitude};e.setCenter(a),n.setPosition(a)})),this.$store.dispatch("buildMap",e),e.addListener("idle",(function(){var e=t.$store.getters.getMap;if(e){var n={location:e.getCenter(),rankBy:google.maps.places.RankBy.DISTANCE,type:"restaurant"};t.$store.dispatch("findOutRestaurants",n)}}))}},created:function(){var t=this;window.addEventListener("load",(function(){t.initMap()}))}};n("fd1b");G.render=i;var Q=G,W=(n("d81d"),n("b85c")),X=Object(g["a"])({state:{map:null,restaurants:[]},getters:{getMap:function(t){return t.map},getResList:function(t){return t.restaurants}},mutations:{storeMap:function(t,e){t.map=e},searchRestaurants:function(t,e){if(t.map){t.restaurants=[];var n=new google.maps.places.PlacesService(t.map);n.nearbySearch(e,(function(a,o){if("OK"===o&&a){var i,r=Object(W["a"])(a);try{for(r.s();!(i=r.n()).done;){var c=i.value;c.geometry&&c.geometry.location&&n.getDetails({placeId:c.place_id},(function(n,a){if(a===google.maps.places.PlacesServiceStatus.OK){var o=n.photos||null,i=google.maps.geometry.spherical.computeDistanceBetween(e.location,n.geometry.location),r={placeId:n.place_id,coords:n.geometry.location,name:n.name,imgUrl:o?o[0].getUrl({maxwidth:200}):"",addr:n.formatted_address,tel:n.formatted_phone_number,openingOrNot:!!n.opening_hours&&n.opening_hours.isOpen(),rating:void 0===n.rating?-1:n.rating,priceLevel:void 0===n.price_level?1/0:n.price_level,minDist:i,url:n.url};t.restaurants.push(r)}}))}}catch(s){r.e(s)}finally{r.f()}}}))}},rearrangeList:function(t,e){t.restaurants=e}},actions:{buildMap:function(t,e){var n=t.commit;n("storeMap",e)},findOutRestaurants:function(t,e){var n=t.commit;n("searchRestaurants",e)},sortRestaurants:function(t,e){var n=t.commit;n("rearrangeList",e)}}});Object(a["c"])(Q).use(X).mount("#app")},"63ca":function(t,e,n){},dc9a:function(t,e,n){"use strict";n("4c62")},e38d:function(t,e,n){"use strict";n("63ca")},fd1b:function(t,e,n){"use strict";n("263d")}});
//# sourceMappingURL=app.799e9e95.js.map